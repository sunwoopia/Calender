{% extends 'base.html' %}
{% block container %}
<div class="container">
            <aside>
            <nav>
                <div>
                    <div style="font-size: 20px; font-weight: bold; margin: 20px">
                        MENU
                    </div>
                    <div>
                        <ul>
                            <li><a href="{% url 'schedule' %}">일정등록</a></li>
                            <li><a href="{% url 'category' %}">카테고리등록</a></li>
                            <li>설정</li>
                        </ul>
                    </div>
                </div>
                <div class="category">
                    <div style="font-size: 20px; font-weight: bold; margin: 20px">
                        CATEGORY
                    </div>
                    <div>
                        <ul>
                            <li><input type="checkbox" style="margin-right: 5px;">WINK</li>
                            <li><input type="checkbox" style="margin-right: 5px;">과제</li>
                            <li><input type="checkbox" style="margin-right: 5px;">술</li>
                            <li><input type="checkbox" style="margin-right: 5px;">기타</li>
                        </ul>
                    </div>
                </div>
            </nav>
        </aside>
        <main>
            <div class="day">
                <div>SUN</div>
                <div>MON</div>
                <div>TUE</div>
                <div>WED</div>
                <div>THU</div>
                <div>FRI</div>
                <div>SAT</div>
            </div>
            <div class="calendar">
                <div class="da"></div>
                <div class="da"></div>
                <div class="da"></div>
                <div class="da"></div>
                <div class="da"></div>
                <div class="da"></div>
                <div class="da"></div>
                <div class="da"></div>
                <div class="da"></div>
                <div class="da"></div>
                <div class="da"></div>
                <div class="da"></div>
                <div class="da"></div>
                <div class="da"></div>
                <div class="da"></div>
                <div class="da"></div>
                <div class="da"></div>
                <div class="da"></div>
                <div class="da"></div>
                <div class="da"></div>
                <div class="da"></div>
                <div class="da"></div>
                <div class="da"></div>
                <div class="da"></div>
                <div class="da"></div>
                <div class="da"></div>
                <div class="da"></div>
                <div class="da"></div>
                <div class="da"></div>
                <div class="da"></div>
                <div class="da"></div>
                <div class="da"></div>
                <div class="da"></div>
                <div class="da"></div>
                <div class="da"></div>
            </div>
        </main>
    </div>
    <footer>
    </footer>
<script src="https://momentjs.com/downloads/moment.js"></script>
<script>
    let arr = [];
    let dictionary = {};
    {% for schedule in post %}
        arr.push({
            startDate: '{{ schedule.startDate }}',
            lastDate: '{{ schedule.lastDate }}',
            title: '{{ schedule.title }}',
            content: '{{ schedule.content }}',
            categoryNum: '{{ schedule.categoryNum}}'
        });
    {% endfor %}
    console.log(arr);
    let now = new Date();
    let firstDate = new Date(now.getFullYear(), now.getMonth(), 1).getDay();
    let lastlast = new Date(now.getFullYear(), now.getMonth(), 0).getDate()
    let lastDate = new Date(now.getFullYear(), now.getMonth() + 1, 0).getDate();
    let dates = document.querySelectorAll('.calendar div');
    let add = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
    let addDay = 1
    for (let i = firstDate; i < lastDate + firstDate; i++) {
        dates[i].innerHTML = add[i-firstDate];
    }
    for (let i = firstDate - 1; i >= 0; i--) {
        dates[i].innerHTML = lastlast;
        lastlast--
    }
    for (let i = lastDate + firstDate ; i < 35; i++) {
        dates[i].innerHTML = addDay;
        addDay++
    }

    for (let i = 0; i < arr.length; i++) {
        let startMom = moment(arr[i]['startDate'], "YYYY-M-D HH:mm")
        let lastMom = moment(arr[i]['lastDate'], "YYYY-M-D HH:mm")
        let mom = parseInt(startMom.format("DD"))
        let mom2 = parseInt(lastMom.format("DD"))
        for (let j = firstDate; j < lastDate; j++) {
            if (parseInt(mom + firstDate - 1) == j) {
                for (let k = j; k <= j + mom2 - mom; k++) {
                    dates[k].innerHTML += "<div class='schedule'><div class='text'> " + arr[i]['title'] + "</div></div>";
                }
            }
        }
    }
</script>
{% endblock %}
