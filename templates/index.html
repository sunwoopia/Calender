{% extends 'base.html' %}
{% block container %}


<div class="subcontainer">
    <a href="{% url 'schedule' %}">일정등록</a>
    <a href="{% url 'category' %}">카테고리등록</a>
</div>
<div class="ct">
    <div class="titlecontainer">
        <div class="day">Sunday</div>
        <div class="day">Monday</div>
        <div class="day">Tuesday</div>
        <div class="day">Wednesday</div>
        <div class="day">Thursday</div>
        <div class="day">Friday</div>
        <div class="day">Saturday</div>
    </div>
    <div class="container">
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
    </div>
</div>
<script src="https://momentjs.com/downloads/moment.js"></script>
<script>
    let arr = [];
    let dictionary = {};
    {% for schedule in post %}
        arr.push({
            startDate: '{{ schedule.startDate }}',
            lastDate: '{{ schedule.lastDate }}',
            title: '{{ schedule.title }}',
            content: '{{ schedule.content }}',
            categoryNum: '{{ schedule.categoryNum}}'
        });
    {% endfor %}
    let now = new Date();
    let firstDate = new Date(now.getFullYear(), now.getMonth(), 1).getDay();
    let lastlast = new Date(now.getFullYear(), now.getMonth(), 0).getDate()
    let lastDate = new Date(now.getFullYear(), now.getMonth() + 1, 0).getDate();
    let dates = document.querySelectorAll('.container div');
    let add = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
    let addDay = 1
    for (let i = firstDate; i < lastDate + firstDate; i++) {
        dates[i].innerHTML = add[i-firstDate];
    }
    for (let i = firstDate - 1; i >= 0; i--) {
        dates[i].innerHTML = lastlast;
        lastlast--
    }
    for (let i = lastDate + firstDate ; i < 35; i++) {
        dates[i].innerHTML = addDay;
        addDay++
    }

    for (let i = 0; i < arr.length; i++) {
        let startMom = moment(arr[i]['startDate'], "YYYY-M-D HH:mm")
        let lastMom = moment(arr[i]['lastDate'], "YYYY-M-D HH:mm")
        let mom = parseInt(startMom.format("DD"))
        let mom2 = parseInt(lastMom.format("DD"))
        for (let j = firstDate; j < lastDate; j++) {
            if (parseInt(mom + firstDate - 1) == j) {
                for (let k = j; k <= j + mom2 - mom; k++) {
                    dates[k].innerHTML += arr[i]['title'];
                }
            }
        }
    }
</script>
{% endblock %}